<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุดุฌุฑุฉ ุงูุจุทููุฉ - ูุฑูุฒ ุดุจุงุจ ุชุงููุณ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="knockout-style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="nav-bar">
        <a href="index.html" class="nav-btn">ุงูุฑุฆูุณูุฉ</a>
        <h1 class="page-title">ุดุฌุฑุฉ ุงูุฃุฏูุงุฑ ุงูุฅูุตุงุฆูุฉ ๐</h1>
    </div>

    <div class="bracket-container">
        
        <div class="bracket-column">
            <h2 class="round-header">ุฏูุฑ ุงูู 16</h2>
            <div id="r16-list">
                </div>
        </div>

        <div class="bracket-column">
            <h2 class="round-header">ุฑุจุน ุงูููุงุฆู</h2>
            <div id="qf-list">
                <div class="match-card"><div class="team-slot">ุ</div><div class="team-slot">ุ</div></div>
                <div class="match-card"><div class="team-slot">ุ</div><div class="team-slot">ุ</div></div>
                <div class="match-card"><div class="team-slot">ุ</div><div class="team-slot">ุ</div></div>
                <div class="match-card"><div class="team-slot">ุ</div><div class="team-slot">ุ</div></div>
            </div>
        </div>

        <div class="bracket-column">
            <h2 class="round-header">ูุตู ุงูููุงุฆู</h2>
            <div id="sf-list">
                <div class="match-card"><div class="team-slot">ุ</div><div class="team-slot">ุ</div></div>
                <div class="match-card"><div class="team-slot">ุ</div><div class="team-slot">ุ</div></div>
            </div>
        </div>

        <div class="bracket-column">
            <h2 class="round-header">ุงูููุงุฆู</h2>
            <div class="match-card gold-border">
                <div class="team-slot">ุ</div>
                <div class="team-slot">ุ</div>
            </div>
            <div class="champion-zone">
                <span>ุงูุจุทู ๐</span>
                <div id="winner-name">ุ</div>
            </div>
        </div>

    </div>

    <script src="data/groups.js"></script>
    <script src="modules/knockout.js"></script>
    <script src="script.js"></script>
   <script>
    // 1. ุฏุงูุฉ ุนุฑุถ ูุจุงุฑูุงุช ุฏูุฑ ุงูู 16 ุนูุฏ ุชุญููู ุงูุตูุญุฉ
    function renderKnockout() {
    const matches = createRound16();
    const container = document.getElementById("r16-list");
    if (!container) return;

    container.innerHTML = ""; // ูุณุญ ุงููุญุชูู ุงููุฏูู

    matches.forEach((m, index) => {
        // ุงูุชุญูู ูู ูุฌูุฏ ุงููุฑูู ุฃู ูุถุน ูุต ุจุฏูู
        const name1 = m[0] ? m[0].name : "ุจุงูุชุธุงุฑ ุงููุชุฃูู";
        const name2 = m[1] ? m[1].name : "ุจุงูุชุธุงุฑ ุงููุชุฃูู";

        container.innerHTML += `
            <div class="match-card">
                <div class="team-slot">
                    <span>${name1}</span>
                    <input type="number" id="m16-${index}-g1" class="score-input">
                </div>
                <div class="team-slot">
                    <span>${name2}</span>
                    <input type="number" id="m16-${index}-g2" class="score-input">
                </div>
                <button onclick="advanceWinner(${index})" class="win-btn">ุชุฃููุฏ ุงููุชุฃูู</button>
            </div>
        `;
    });
}

    // 2. ุฏุงูุฉ ุชุญุฏูุฏ ุงููุงุฆุฒ ูุชุณุฌูู ุงููุฏุงููู ูุชุตุนูุฏ ุงููุฑูู ููุฏูุฑ ุงูุชุงูู
    function advanceWinner(matchIndex) {
        const g1 = parseInt(document.getElementById(`m16-${matchIndex}-g1`).value);
        const g2 = parseInt(document.getElementById(`m16-${matchIndex}-g2`).value);
        
        if (isNaN(g1) || isNaN(g2)) return alert("ุจุฑุฌุงุก ุฅุฏุฎุงู ุงูุฃูุฏุงู ุฃููุงู");

        const matches = createRound16();
        const team1 = matches[matchIndex][0];
        const team2 = matches[matchIndex][1];

        // --- ุชุณุฌูู ุงููุฏุงููู ---
        if (g1 > 0) recordScorers(team1.name, g1);
        if (g2 > 0) recordScorers(team2.name, g2);

        // --- ุชุญุฏูุฏ ุงููุงุฆุฒ ---
        let winnerName = "";
        if (g1 > g2) {
            winnerName = team1.name;
        } else if (g2 > g1) {
            winnerName = team2.name;
        } else {
            return alert("ูุฌุจ ูุฌูุฏ ูุงุฆุฒ (ูู ุญุงู ุงูุชุนุงุฏูุ ุฃุฏุฎู ูุชูุฌุฉ ุฑููุงุช ุงูุชุฑุฌูุญ)");
        }

        // --- ููู ุงููุงุฆุฒ ูุฑุจุน ุงูููุงุฆู ---
        const qfIndex = Math.floor(matchIndex / 2);
        const slotInQf = matchIndex % 2;
        const qfMatches = document.querySelectorAll("#qf-list .match-card");
        
        if (qfMatches[qfIndex]) {
            const targetSlot = qfMatches[qfIndex].querySelectorAll(".team-slot")[slotInQf];
            targetSlot.innerText = winnerName;
            targetSlot.classList.add("winner-highlight");
            alert(`ุชู ุชุฃูู ${winnerName} ูุชุญุฏูุซ ูุงุฆูุฉ ุงููุฏุงููู ุจูุฌุงุญ!`);
        }
    }

    // 3. ุฏุงูุฉ ุงููุงูุฐุฉ ุงูููุจุซูุฉ ูุฃุณูุงุก ุงููุงุนุจูู
    function recordScorers(teamName, goalsCount) {
        for (let i = 1; i <= goalsCount; i++) {
            let playerName = prompt(`ูู ุณุฌู ุงููุฏู ุฑูู (${i}) ููุฑูู [ ${teamName} ]ุ`);
            if (playerName && playerName.trim() !== "") {
                addGoal(playerName, teamName); // ุชูุงุฏู ุงูุฏุงูุฉ ุงูููุฌูุฏุฉ ูู script.js
            }
        }
    }

    // ุชุดุบูู ุงูุฏุงูุฉ ุนูุฏ ูุชุญ ุงูุตูุญุฉ
    window.onload = renderKnockout;
</script>
</body>
</html>